{"ast":null,"code":"import React,{useState,useEffect,useContext}from'react';import axios from'axios';import{Link}from'react-router-dom';import AuthContext from'../../contexts/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const StaffRenewPackagePage=()=>{const[memberId,setMemberId]=useState('');const[newPackageId,setNewPackageId]=useState('');const[packages,setPackages]=useState([]);const[error,setError]=useState('');const[success,setSuccess]=useState('');const[isSubmitting,setIsSubmitting]=useState(false);const auth=useContext(AuthContext);// Fetch all available packages when the component loads\nuseEffect(()=>{const fetchPackages=async()=>{try{const res=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/packages\"));setPackages(res.data);if(res.data.length>0){setNewPackageId(res.data[0].package_id);}}catch(err){setError('Failed to load packages. Please check the server connection.');}};fetchPackages();},[]);const handleSubmit=async e=>{e.preventDefault();setIsSubmitting(true);setError('');setSuccess('');if(!memberId||!newPackageId){setError('Please enter a Member User ID and select a package.');setIsSubmitting(false);return;}try{const config={headers:{Authorization:\"Bearer \".concat(auth.token)}};const body={memberId:Number(memberId),newPackageId:Number(newPackageId)};const res=await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/members/extend-subscription\"),body,config);setSuccess(\"\".concat(res.data.msg,\" New end date for member \").concat(memberId,\": \").concat(new Date(res.data.newSubscription.end_date).toLocaleDateString()));setMemberId('');// Clear the member ID field for the next use\n}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.msg)||'An error occurred during extension.');}finally{setIsSubmitting(false);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Link,{to:\"/dashboard\",children:\"\\u2190 Back to Dashboard\"}),/*#__PURE__*/_jsx(\"h2\",{style:{marginTop:'1rem'},children:\"Gia h\\u1EA1n g\\xF3i t\\u1EADp cho h\\u1ED9i vi\\xEAn\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Enter the member's User ID and select the new package to add to their subscription.\"}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red',border:'1px solid red',padding:'10px'},children:error}),success&&/*#__PURE__*/_jsx(\"p\",{style:{color:'green',border:'1px solid green',padding:'10px'},children:success}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Member User ID:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:memberId,onChange:e=>setMemberId(e.target.value),placeholder:\"Enter User ID (e.g., 1, 2, 3...)\",required:true,style:{display:'block',width:'300px',margin:'5px 0',padding:'8px'}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'1rem'},children:[/*#__PURE__*/_jsx(\"label\",{children:\"New Package to Extend:\"}),/*#__PURE__*/_jsx(\"select\",{value:newPackageId,onChange:e=>setNewPackageId(e.target.value),required:true,style:{display:'block',width:'300px',margin:'5px 0',padding:'8px'},children:packages.map(pkg=>/*#__PURE__*/_jsxs(\"option\",{value:pkg.package_id,children:[pkg.package_name,\" - \",Number(pkg.price).toLocaleString(),\" VND\"]},pkg.package_id))})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:isSubmitting,style:{marginTop:'1.5rem'},children:isSubmitting?'Extending...':'Extend Subscription'})]})]});};export default StaffRenewPackagePage;","map":{"version":3,"names":["React","useState","useEffect","useContext","axios","Link","AuthContext","jsx","_jsx","jsxs","_jsxs","StaffRenewPackagePage","memberId","setMemberId","newPackageId","setNewPackageId","packages","setPackages","error","setError","success","setSuccess","isSubmitting","setIsSubmitting","auth","fetchPackages","res","get","concat","process","env","REACT_APP_API_URL","data","length","package_id","err","handleSubmit","e","preventDefault","config","headers","Authorization","token","body","Number","post","msg","Date","newSubscription","end_date","toLocaleDateString","_err$response","_err$response$data","response","children","to","style","marginTop","color","border","padding","onSubmit","type","value","onChange","target","placeholder","required","display","width","margin","map","pkg","package_name","price","toLocaleString","disabled"],"sources":["D:/GITHUB/IT4549-156729-Group16/frontend/src/pages/Staff/StaffRenewPackagePage.jsx"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\r\nimport axios from 'axios';\r\nimport { Link } from 'react-router-dom';\r\nimport AuthContext from '../../contexts/AuthContext';\r\n\r\nconst StaffRenewPackagePage = () => {\r\n  const [memberId, setMemberId] = useState('');\r\n  const [newPackageId, setNewPackageId] = useState('');\r\n  const [packages, setPackages] = useState([]);\r\n  \r\n  const [error, setError] = useState('');\r\n  const [success, setSuccess] = useState('');\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  \r\n  const auth  = useContext(AuthContext);\r\n\r\n  // Fetch all available packages when the component loads\r\n  useEffect(() => {\r\n    const fetchPackages = async () => {\r\n      try {\r\n        const res = await axios.get(`${process.env.REACT_APP_API_URL}/packages`);\r\n        setPackages(res.data);\r\n        if (res.data.length > 0) {\r\n            setNewPackageId(res.data[0].package_id);\r\n        }\r\n      } catch (err) {\r\n        setError('Failed to load packages. Please check the server connection.');\r\n      }\r\n    };\r\n    fetchPackages();\r\n  }, []);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setIsSubmitting(true);\r\n    setError('');\r\n    setSuccess('');\r\n\r\n    if (!memberId || !newPackageId) {\r\n      setError('Please enter a Member User ID and select a package.');\r\n      setIsSubmitting(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${auth.token}`,\r\n        },\r\n      };\r\n      \r\n      const body = { \r\n        memberId: Number(memberId), \r\n        newPackageId: Number(newPackageId) \r\n      };\r\n\r\n      const res = await axios.post(`${process.env.REACT_APP_API_URL}/members/extend-subscription`, body, config);\r\n      \r\n      setSuccess(`${res.data.msg} New end date for member ${memberId}: ${new Date(res.data.newSubscription.end_date).toLocaleDateString()}`);\r\n      setMemberId(''); // Clear the member ID field for the next use\r\n\r\n    } catch (err) {\r\n      setError(err.response?.data?.msg || 'An error occurred during extension.');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Link to=\"/dashboard\">← Back to Dashboard</Link>\r\n      <h2 style={{marginTop: '1rem'}}>Gia hạn gói tập cho hội viên</h2>\r\n      <p>Enter the member's User ID and select the new package to add to their subscription.</p>\r\n      \r\n      {error && <p style={{ color: 'red', border: '1px solid red', padding: '10px' }}>{error}</p>}\r\n      {success && <p style={{ color: 'green', border: '1px solid green', padding: '10px' }}>{success}</p>}\r\n\r\n      <form onSubmit={handleSubmit}>\r\n        <div>\r\n          <label>Member User ID:</label>\r\n          <input\r\n            type=\"number\"\r\n            value={memberId}\r\n            onChange={(e) => setMemberId(e.target.value)}\r\n            placeholder=\"Enter User ID (e.g., 1, 2, 3...)\"\r\n            required\r\n            style={{ display: 'block', width: '300px', margin: '5px 0', padding: '8px' }}\r\n          />\r\n        </div>\r\n        <div style={{marginTop: '1rem'}}>\r\n          <label>New Package to Extend:</label>\r\n          <select\r\n            value={newPackageId}\r\n            onChange={(e) => setNewPackageId(e.target.value)}\r\n            required\r\n            style={{ display: 'block', width: '300px', margin: '5px 0', padding: '8px' }}\r\n          >\r\n            {packages.map((pkg) => (\r\n              <option key={pkg.package_id} value={pkg.package_id}>\r\n                {pkg.package_name} - {Number(pkg.price).toLocaleString()} VND\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n        <button type=\"submit\" disabled={isSubmitting} style={{marginTop: '1.5rem'}}>\r\n          {isSubmitting ? 'Extending...' : 'Extend Subscription'}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StaffRenewPackagePage;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,UAAU,KAAQ,OAAO,CAC9D,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,IAAI,KAAQ,kBAAkB,CACvC,MAAO,CAAAC,WAAW,KAAM,4BAA4B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAErD,KAAM,CAAAC,qBAAqB,CAAGA,CAAA,GAAM,CAClC,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACa,YAAY,CAAEC,eAAe,CAAC,CAAGd,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACe,QAAQ,CAAEC,WAAW,CAAC,CAAGhB,QAAQ,CAAC,EAAE,CAAC,CAE5C,KAAM,CAACiB,KAAK,CAAEC,QAAQ,CAAC,CAAGlB,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACmB,OAAO,CAAEC,UAAU,CAAC,CAAGpB,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACqB,YAAY,CAAEC,eAAe,CAAC,CAAGtB,QAAQ,CAAC,KAAK,CAAC,CAEvD,KAAM,CAAAuB,IAAI,CAAIrB,UAAU,CAACG,WAAW,CAAC,CAErC;AACAJ,SAAS,CAAC,IAAM,CACd,KAAM,CAAAuB,aAAa,CAAG,KAAAA,CAAA,GAAY,CAChC,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAtB,KAAK,CAACuB,GAAG,IAAAC,MAAA,CAAIC,OAAO,CAACC,GAAG,CAACC,iBAAiB,aAAW,CAAC,CACxEd,WAAW,CAACS,GAAG,CAACM,IAAI,CAAC,CACrB,GAAIN,GAAG,CAACM,IAAI,CAACC,MAAM,CAAG,CAAC,CAAE,CACrBlB,eAAe,CAACW,GAAG,CAACM,IAAI,CAAC,CAAC,CAAC,CAACE,UAAU,CAAC,CAC3C,CACF,CAAE,MAAOC,GAAG,CAAE,CACZhB,QAAQ,CAAC,8DAA8D,CAAC,CAC1E,CACF,CAAC,CACDM,aAAa,CAAC,CAAC,CACjB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAW,YAAY,CAAG,KAAO,CAAAC,CAAC,EAAK,CAChCA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClBf,eAAe,CAAC,IAAI,CAAC,CACrBJ,QAAQ,CAAC,EAAE,CAAC,CACZE,UAAU,CAAC,EAAE,CAAC,CAEd,GAAI,CAACT,QAAQ,EAAI,CAACE,YAAY,CAAE,CAC9BK,QAAQ,CAAC,qDAAqD,CAAC,CAC/DI,eAAe,CAAC,KAAK,CAAC,CACtB,OACF,CAEA,GAAI,CACF,KAAM,CAAAgB,MAAM,CAAG,CACbC,OAAO,CAAE,CACPC,aAAa,WAAAb,MAAA,CAAYJ,IAAI,CAACkB,KAAK,CACrC,CACF,CAAC,CAED,KAAM,CAAAC,IAAI,CAAG,CACX/B,QAAQ,CAAEgC,MAAM,CAAChC,QAAQ,CAAC,CAC1BE,YAAY,CAAE8B,MAAM,CAAC9B,YAAY,CACnC,CAAC,CAED,KAAM,CAAAY,GAAG,CAAG,KAAM,CAAAtB,KAAK,CAACyC,IAAI,IAAAjB,MAAA,CAAIC,OAAO,CAACC,GAAG,CAACC,iBAAiB,iCAAgCY,IAAI,CAAEJ,MAAM,CAAC,CAE1GlB,UAAU,IAAAO,MAAA,CAAIF,GAAG,CAACM,IAAI,CAACc,GAAG,8BAAAlB,MAAA,CAA4BhB,QAAQ,OAAAgB,MAAA,CAAK,GAAI,CAAAmB,IAAI,CAACrB,GAAG,CAACM,IAAI,CAACgB,eAAe,CAACC,QAAQ,CAAC,CAACC,kBAAkB,CAAC,CAAC,CAAE,CAAC,CACtIrC,WAAW,CAAC,EAAE,CAAC,CAAE;AAEnB,CAAE,MAAOsB,GAAG,CAAE,KAAAgB,aAAA,CAAAC,kBAAA,CACZjC,QAAQ,CAAC,EAAAgC,aAAA,CAAAhB,GAAG,CAACkB,QAAQ,UAAAF,aAAA,kBAAAC,kBAAA,CAAZD,aAAA,CAAcnB,IAAI,UAAAoB,kBAAA,iBAAlBA,kBAAA,CAAoBN,GAAG,GAAI,qCAAqC,CAAC,CAC5E,CAAC,OAAS,CACRvB,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,mBACEb,KAAA,QAAA4C,QAAA,eACE9C,IAAA,CAACH,IAAI,EAACkD,EAAE,CAAC,YAAY,CAAAD,QAAA,CAAC,0BAAmB,CAAM,CAAC,cAChD9C,IAAA,OAAIgD,KAAK,CAAE,CAACC,SAAS,CAAE,MAAM,CAAE,CAAAH,QAAA,CAAC,mDAA4B,CAAI,CAAC,cACjE9C,IAAA,MAAA8C,QAAA,CAAG,qFAAmF,CAAG,CAAC,CAEzFpC,KAAK,eAAIV,IAAA,MAAGgD,KAAK,CAAE,CAAEE,KAAK,CAAE,KAAK,CAAEC,MAAM,CAAE,eAAe,CAAEC,OAAO,CAAE,MAAO,CAAE,CAAAN,QAAA,CAAEpC,KAAK,CAAI,CAAC,CAC1FE,OAAO,eAAIZ,IAAA,MAAGgD,KAAK,CAAE,CAAEE,KAAK,CAAE,OAAO,CAAEC,MAAM,CAAE,iBAAiB,CAAEC,OAAO,CAAE,MAAO,CAAE,CAAAN,QAAA,CAAElC,OAAO,CAAI,CAAC,cAEnGV,KAAA,SAAMmD,QAAQ,CAAEzB,YAAa,CAAAkB,QAAA,eAC3B5C,KAAA,QAAA4C,QAAA,eACE9C,IAAA,UAAA8C,QAAA,CAAO,iBAAe,CAAO,CAAC,cAC9B9C,IAAA,UACEsD,IAAI,CAAC,QAAQ,CACbC,KAAK,CAAEnD,QAAS,CAChBoD,QAAQ,CAAG3B,CAAC,EAAKxB,WAAW,CAACwB,CAAC,CAAC4B,MAAM,CAACF,KAAK,CAAE,CAC7CG,WAAW,CAAC,kCAAkC,CAC9CC,QAAQ,MACRX,KAAK,CAAE,CAAEY,OAAO,CAAE,OAAO,CAAEC,KAAK,CAAE,OAAO,CAAEC,MAAM,CAAE,OAAO,CAAEV,OAAO,CAAE,KAAM,CAAE,CAC9E,CAAC,EACC,CAAC,cACNlD,KAAA,QAAK8C,KAAK,CAAE,CAACC,SAAS,CAAE,MAAM,CAAE,CAAAH,QAAA,eAC9B9C,IAAA,UAAA8C,QAAA,CAAO,wBAAsB,CAAO,CAAC,cACrC9C,IAAA,WACEuD,KAAK,CAAEjD,YAAa,CACpBkD,QAAQ,CAAG3B,CAAC,EAAKtB,eAAe,CAACsB,CAAC,CAAC4B,MAAM,CAACF,KAAK,CAAE,CACjDI,QAAQ,MACRX,KAAK,CAAE,CAAEY,OAAO,CAAE,OAAO,CAAEC,KAAK,CAAE,OAAO,CAAEC,MAAM,CAAE,OAAO,CAAEV,OAAO,CAAE,KAAM,CAAE,CAAAN,QAAA,CAE5EtC,QAAQ,CAACuD,GAAG,CAAEC,GAAG,eAChB9D,KAAA,WAA6BqD,KAAK,CAAES,GAAG,CAACtC,UAAW,CAAAoB,QAAA,EAChDkB,GAAG,CAACC,YAAY,CAAC,KAAG,CAAC7B,MAAM,CAAC4B,GAAG,CAACE,KAAK,CAAC,CAACC,cAAc,CAAC,CAAC,CAAC,MAC3D,GAFaH,GAAG,CAACtC,UAET,CACT,CAAC,CACI,CAAC,EACN,CAAC,cACN1B,IAAA,WAAQsD,IAAI,CAAC,QAAQ,CAACc,QAAQ,CAAEtD,YAAa,CAACkC,KAAK,CAAE,CAACC,SAAS,CAAE,QAAQ,CAAE,CAAAH,QAAA,CACxEhC,YAAY,CAAG,cAAc,CAAG,qBAAqB,CAChD,CAAC,EACL,CAAC,EACJ,CAAC,CAEV,CAAC,CAED,cAAe,CAAAX,qBAAqB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}