{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import SimulatedPaymentForm from'./SimulatedPaymentForm';// Import the new component\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MemberPaymentPage=()=>{// State for data fetched from the backend\nconst[packages,setPackages]=useState([]);const[isLoading,setIsLoading]=useState(true);// State for user interaction\nconst[selectedPackageId,setSelectedPackageId]=useState('');// State for showing top-level feedback\nconst[error,setError]=useState('');const[success,setSuccess]=useState('');// Fetch active packages from the backend when the component mounts\nuseEffect(()=>{const fetchPackages=async()=>{try{const response=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/packages\"));setPackages(response.data);// Automatically select the first package if available\nif(response.data.length>0){setSelectedPackageId(response.data[0].package_id);}}catch(err){setError('Could not load membership packages. Please try again later.');console.error('Fetch packages error:',err);}finally{setIsLoading(false);}};fetchPackages();},[]);// Find the full object for the selected package\nconst selectedPackage=packages.find(pkg=>pkg.package_id===selectedPackageId);const handlePaymentSuccess=data=>{setSuccess(\"Successfully subscribed to \".concat(selectedPackage===null||selectedPackage===void 0?void 0:selectedPackage.package_name,\"!\"));setError('');// Optionally, you could navigate the user away or refresh their subscription data\n};const handlePaymentError=errorMessage=>{setError(errorMessage);setSuccess('');};if(isLoading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading packages...\"});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Thanh to\\xE1n G\\xF3i t\\u1EADp\"}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red',border:'1px solid red',padding:'10px'},children:error}),success&&/*#__PURE__*/_jsx(\"p\",{style:{color:'green',border:'1px solid green',padding:'10px'},children:success}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'2rem'},children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"packageSelect\",children:\"Ch\\u1ECDn G\\xF3i t\\u1EADp:\"}),/*#__PURE__*/_jsx(\"select\",{id:\"packageSelect\",value:selectedPackageId,onChange:e=>setSelectedPackageId(Number(e.target.value))// Convert value to Number\n,required:true,children:packages.map(pkg=>/*#__PURE__*/_jsxs(\"option\",{value:pkg.package_id,children:[pkg.package_name,\" - \",Number(pkg.price).toLocaleString(),\" VND\"]},pkg.package_id))})]}),selectedPackage?/*#__PURE__*/_jsx(SimulatedPaymentForm// Pass the necessary props to the child component\n,{packageId:selectedPackage.package_id,packagePrice:selectedPackage.price,onPaymentSuccess:handlePaymentSuccess,onPaymentError:handlePaymentError}):/*#__PURE__*/_jsx(\"p\",{children:\"Please select a package to see payment options.\"})]});};export default MemberPaymentPage;","map":{"version":3,"names":["React","useState","useEffect","axios","SimulatedPaymentForm","jsx","_jsx","jsxs","_jsxs","MemberPaymentPage","packages","setPackages","isLoading","setIsLoading","selectedPackageId","setSelectedPackageId","error","setError","success","setSuccess","fetchPackages","response","get","concat","process","env","REACT_APP_API_URL","data","length","package_id","err","console","selectedPackage","find","pkg","handlePaymentSuccess","package_name","handlePaymentError","errorMessage","children","style","color","border","padding","marginBottom","htmlFor","id","value","onChange","e","Number","target","required","map","price","toLocaleString","packageId","packagePrice","onPaymentSuccess","onPaymentError"],"sources":["D:/GITHUB/IT4549-156729-Group16/frontend/src/pages/Member/MemberPaymentPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport SimulatedPaymentForm from './SimulatedPaymentForm'; // Import the new component\r\n\r\nconst MemberPaymentPage = () => {\r\n  // State for data fetched from the backend\r\n  const [packages, setPackages] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  // State for user interaction\r\n  const [selectedPackageId, setSelectedPackageId] = useState('');\r\n\r\n  // State for showing top-level feedback\r\n  const [error, setError] = useState('');\r\n  const [success, setSuccess] = useState('');\r\n\r\n  // Fetch active packages from the backend when the component mounts\r\n  useEffect(() => {\r\n    const fetchPackages = async () => {\r\n      try {\r\n        const response = await axios.get(`${process.env.REACT_APP_API_URL}/packages`);\r\n        setPackages(response.data);\r\n        // Automatically select the first package if available\r\n        if (response.data.length > 0) {\r\n          setSelectedPackageId(response.data[0].package_id);\r\n        }\r\n      } catch (err) {\r\n        setError('Could not load membership packages. Please try again later.');\r\n        console.error('Fetch packages error:', err);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchPackages();\r\n  }, []);\r\n\r\n  // Find the full object for the selected package\r\n  const selectedPackage = packages.find(\r\n    (pkg) => pkg.package_id === selectedPackageId\r\n  );\r\n\r\n  const handlePaymentSuccess = (data) => {\r\n    setSuccess(`Successfully subscribed to ${selectedPackage?.package_name}!`);\r\n    setError('');\r\n    // Optionally, you could navigate the user away or refresh their subscription data\r\n  };\r\n\r\n  const handlePaymentError = (errorMessage) => {\r\n    setError(errorMessage);\r\n    setSuccess('');\r\n  };\r\n\r\n  if (isLoading) {\r\n    return <div>Loading packages...</div>;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h2>Thanh toán Gói tập</h2>\r\n      {/* Display top-level success/error messages here */}\r\n      {error && <p style={{ color: 'red', border: '1px solid red', padding: '10px' }}>{error}</p>}\r\n      {success && <p style={{ color: 'green', border: '1px solid green', padding: '10px' }}>{success}</p>}\r\n\r\n      <div style={{ marginBottom: '2rem' }}>\r\n        <label htmlFor=\"packageSelect\">Chọn Gói tập:</label>\r\n        <select\r\n          id=\"packageSelect\"\r\n          value={selectedPackageId}\r\n          onChange={(e) => setSelectedPackageId(Number(e.target.value))} // Convert value to Number\r\n          required\r\n        >\r\n          {packages.map((pkg) => (\r\n            <option key={pkg.package_id} value={pkg.package_id}>\r\n              {pkg.package_name} - {Number(pkg.price).toLocaleString()} VND\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {/* --- Integration of the Simulated Payment Form --- */}\r\n      {/* Only show the payment form if a package has been selected */}\r\n      {selectedPackage ? (\r\n        <SimulatedPaymentForm\r\n          // Pass the necessary props to the child component\r\n          packageId={selectedPackage.package_id}\r\n          packagePrice={selectedPackage.price}\r\n          onPaymentSuccess={handlePaymentSuccess}\r\n          onPaymentError={handlePaymentError}\r\n        />\r\n      ) : (\r\n        <p>Please select a package to see payment options.</p>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MemberPaymentPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}